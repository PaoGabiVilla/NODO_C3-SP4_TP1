<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Editar Superhéroe</title>
  <link rel="stylesheet" href="/style.css">
</head>
<body>
  <h1>Editar Superhéroe</h1>

  <!-- Formulario para editar, usando method-override -->
  <form class="edit" action="/api/heroes/<%= superheroe._id %>?_method=PUT" method="POST">
        <% /* El campo oculto '_method=PUT' le dice a method-override que trate esta POST como PUT */ %>
        <% /* La acción apunta a la ruta de actualización con el ID del superhéroe */ %>
    
    <label for="nombreSuperHeroe">Nombre:</label>
    <input type="text" id="nombreSuperHeroe" name="nombreSuperHeroe" value="<%= superheroe.nombreSuperHeroe %>" required minlength="3" maxlength="60"><br><br>

    <label for="nombreReal">Nombre Real:</label>
    <input type="text" id="nombreReal" name="nombreReal" value="<%= superheroe.nombreReal %>" required minlength="3" maxlength="60"><br><br>

    <label for="edad">Edad:</label>
    <input type="number" id="edad" name="edad" min="0" value="<%= superheroe.edad %>" required><br><br>

    <label for="planetaOrigen">Planeta de Origen:</label>
    <input type="text" id="planetaOrigen" name="planetaOrigen" value="<%= superheroe.planetaOrigen %>" required><br><br>

    <label for="debilidad">Debilidad:</label>
    <input type="text" id="debilidad" name="debilidad" value="<%= superheroe.debilidad %>" required><br><br>

    <label for="poderes">Poderes (separados por coma):</label>
    <input type="text" id="poderes" name="poderes" 
           value="<%= superheroe.poderes ? superheroe.poderes.join(', ') : '' %>" required><br><br>

    <label for="aliados">Aliados (separados por coma):</label>
    <input type="text" id="aliados" name="aliados" 
           value="<%= superheroe.aliados ? superheroe.aliados.join(', ') : '' %>" required><br><br>

    <label for="enemigos">Enemigos (separados por coma):</label>
    <input type="text" id="enemigos" name="enemigos" 
           value="<%= superheroe.enemigos ? superheroe.enemigos.join(', ') : '' %>" required><br><br>

    <label for="creador">Creador:</label>
    <input type="text" id="creador" name="creador" value="<%= superheroe.creador %>" required><br><br>

    <button type="submit" class="btn">Guardar</button>

    <br><br><br>
       <a href="/api/heroes"> Volver al Dashboard</a>

  </form>
 <script>
    const form = document.querySelector('.add');

    form.addEventListener('submit', function (e) {
        const poderesInput = document.getElementById('poderes');
        const poderesTexto = poderesInput.value.trim();

        if (!poderesTexto) {
            alert("El campo 'Poderes' es requerido.");
            e.preventDefault();
            return;
        }

        const poderesArray = poderesTexto.split(',').map(p => p.trim());

        if (poderesArray.length === 0) {
            alert("Debe ingresar al menos un poder.");
            e.preventDefault();
            return;
        }

        for (let i = 0; i < poderesArray.length; i++) {
            const poder = poderesArray[i];

            if (!poder) {
                alert(`El poder en la posición ${i + 1} está vacío.`);
                e.preventDefault();
                return;
            }

            if (poder.includes(' ')) {
                alert(`El poder "${poder}" no debe contener espacios en blanco.`);
                e.preventDefault();
                return;
            }

            if (poder.length < 3) {
                alert(`El poder "${poder}" debe tener al menos 3 caracteres.`);
                e.preventDefault();
                return;
            }

            if (poder.length > 60) {
                alert(`El poder "${poder}" no debe superar los 60 caracteres.`);
                e.preventDefault();
                return;
            }
        }

        // Si pasa todo, el formulario se envía normalmente
    });
</script>
  </body>
</html>
